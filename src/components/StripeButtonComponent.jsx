import React from "react";
import StripeCheckout from "react-stripe-checkout";
import ShoppingCartService from "../services/ShoppingCartService";
import axios from "./../axios/AxiosHelper";


const StripeButton = ({ price }) => {
  const publishableKey = "pk_test_NK0fB26hd3fYpqNMGPSC89Ml00clSxoBR2";
  const stripePrice = price * 100;
  const user = JSON.parse(localStorage.getItem('user'));         
  const username = user.username;

  const onToken = (token) => {
    console.log(token);
    axios
      .post("/api/shopping-carts/charge", {
        amount: stripePrice,
        token,
      })
      .then((response) => {
        console.log(response);
        alert("Payment successfull");
        ShoppingCartService.clearCart();
        window.location = "/courses";
      })
      .catch((error) => {
        console.log(error);
        alert("Payment failed");
      });
  };

  return ((stripePrice > 0) ?
    <StripeCheckout
      amount={`${stripePrice}`}
      label="Pay Now"
      name={username}
      image="data:image/jpeg;base64,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"
      description={`Your total is ${price} $`}
      panelLabel="Pay Now"
      token={onToken}
      stripeKey={publishableKey}
      currency="EUR"
    /> : ''
  );
};

export default StripeButton;